{"version":3,"sources":["utils/aqiColors.js","utils/formatDate.js","components/Aqi.js","utils/buildAqiColor.js","components/AqiIndicator.js","App.js","reportWebVitals.js","index.js"],"names":["colorIndicator","good","satisfactory","moderate","poor","veryPoor","severe","timeAgo","date","sec","Date","getTime","parseInt","min","h","d","m","y","Aqi","useState","airAqiData","setAirAqiData","useEffect","connectInterval","timeout","ws","WebSocket","onopen","console","log","clearTimeout","onmessage","e","data","JSON","parse","Array","isArray","newData","reduce","initial","current","timestamp","city","a","onclose","Math","reason","setTimeout","check","onerror","err","error","message","close","state","readyState","CLOSED","connect","className","cities","Object","keys","length","cellPadding","cellSpacing","border","map","aqi","cityData","style","backgroundColor","toFixed","renderChildren","AqiIndicator","App","reportWebVitals","onPerfEntry","Function","then","getCLS","getFID","getFCP","getLCP","getTTFB","ReactDOM","render","StrictMode","document","getElementById"],"mappings":"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","file":"static/js/main.8996cf4c.chunk.js","sourcesContent":["export const colorIndicator = {\r\n  good: '#66BB6A',\r\n  satisfactory: '#9CCC65',\r\n  moderate: '#D4E157',\r\n  poor: '#FFA726',\r\n  veryPoor: '#F44336',\r\n  severe: '#B71C1C',\r\n}","export const timeAgo = (date) => {\r\n  var currDate = new Date();\r\n  var diffMs = currDate.getTime() - new Date(date).getTime();\r\n  var sec = diffMs / 1000;\r\n  if (parseInt(sec) === 0) return \"Just Now\";\r\n  if (sec < 60)\r\n    return parseInt(sec) + \" second\" + (parseInt(sec) > 1 ? \"s\" : \"\") + \" ago\";\r\n  var min = sec / 60;\r\n  if (min < 60)\r\n    return parseInt(min) + \" minute\" + (parseInt(min) > 1 ? \"s\" : \"\") + \" ago\";\r\n  var h = min / 60;\r\n  if (h < 24)\r\n    return parseInt(h) + \" hour\" + (parseInt(h) > 1 ? \"s\" : \"\") + \" ago\";\r\n  var d = h / 24;\r\n  if (d < 30)\r\n    return parseInt(d) + \" day\" + (parseInt(d) > 1 ? \"s\" : \"\") + \" ago\";\r\n  var m = d / 30;\r\n  if (m < 12)\r\n    return parseInt(m) + \" month\" + (parseInt(m) > 1 ? \"s\" : \"\") + \" ago\";\r\n  var y = m / 12;\r\n  return parseInt(y) + \" year\" + (parseInt(y) > 1 ? \"s\" : \"\") + \" ago\";\r\n};\r\n","import React, { useState, useEffect } from \"react\";\r\nimport { buildAqiColor, timeAgo } from '../utils';\r\n\r\nconst Aqi = () => {\r\n  const [airAqiData, setAirAqiData] = useState(null);\r\n\r\n  useEffect(() => {\r\n    (() => {\r\n      let timeout = 250;\r\n      const ws = new WebSocket(\"wss://city-ws.herokuapp.com/â€Œ\");\r\n      let connectInterval;\r\n\r\n      // websocket onopen event listener\r\n      ws.onopen = () => {\r\n        console.log(\"connected websocket app component\");\r\n\r\n        timeout = 250; // reset timer to 250 on open of websocket connection\r\n        clearTimeout(connectInterval); // clear Interval on on open of websocket connection\r\n      };\r\n\r\n      ws.onmessage = (e) => {\r\n        let data = JSON.parse(e.data);\r\n        if (data && Array.isArray(data)) {\r\n          const newData = data.reduce((initial, current) => {\r\n            current.timestamp = new Date();\r\n            initial[current.city] = current;\r\n            return initial;\r\n          }, {});\r\n          setAirAqiData(a => (a ? {...a, ...newData} : newData));\r\n        }\r\n      }\r\n\r\n      // websocket onclose event listener\r\n      ws.onclose = (e) => {\r\n        console.log(\r\n          `Socket is closed. Reconnect will be attempted in ${Math.min(\r\n            10000 / 1000,\r\n            (timeout + timeout) / 1000\r\n          )} second.`,\r\n          e.reason\r\n        );\r\n\r\n        timeout = timeout + timeout; //increment retry interval\r\n        connectInterval = setTimeout(check, Math.min(10000, timeout)); //call check function after timeout\r\n      };\r\n\r\n      // websocket onerror event listener\r\n      ws.onerror = (err) => {\r\n        console.error(\r\n          \"Socket encountered error: \",\r\n          err.message,\r\n          \"Closing socket\"\r\n        );\r\n\r\n        ws.close();\r\n      };\r\n    })();\r\n  }, []);\r\n\r\n  /**\r\n   * utilited by the @function connect to check if the connection is close, if so attempts to reconnect\r\n   */\r\n  const check = () => {\r\n    const { ws } = this.state;\r\n    if (!ws || ws.readyState === WebSocket.CLOSED) this.connect(); //check if websocket instance is closed, if so call `connect` function.\r\n  };\r\n\r\n  const renderChildren = () => {\r\n    if (airAqiData === null) return <p className=\"noContent\">Loading...</p>\r\n    const cities = Object.keys(airAqiData);\r\n    if (cities.length === 0)\r\n      return <p className=\"noContent\">No Data Found.</p>\r\n    return (\r\n      <table cellPadding=\"0\" cellSpacing=\"0\" border=\"0\" className=\"apiTable\">\r\n        <thead>\r\n          <tr>\r\n            <td>City</td>\r\n            <td>Current AQI</td>\r\n            <td>Last Updated</td>\r\n          </tr>\r\n        </thead>\r\n        <tbody>\r\n        {cities.map(city => {\r\n          const cityData = airAqiData[city];\r\n          return (\r\n            <tr key={city} style={{backgroundColor: buildAqiColor(cityData.aqi)}}>\r\n              <td>{cityData.city}</td>\r\n              <td>{cityData.aqi.toFixed(2)}</td>\r\n              <td>{timeAgo(cityData.timestamp)}</td>\r\n            </tr>\r\n          )\r\n        })}\r\n        </tbody>\r\n      </table>\r\n    )\r\n  }\r\n\r\n  return renderChildren();\r\n};\r\n\r\nexport default Aqi;\r\n","import { colorIndicator } from '../utils';\r\n\r\nexport const buildAqiColor = (aqi) => {\r\n  if (aqi >= 0 && aqi <= 50) return colorIndicator.good;\r\n  if (aqi > 50 && aqi <= 100) return colorIndicator.satisfactory;\r\n  if (aqi > 100 && aqi <= 200) return colorIndicator.moderate;\r\n  if (aqi > 200 && aqi <= 300) return colorIndicator.poor;\r\n  if (aqi > 300 && aqi <= 400) return colorIndicator.veryPoor;\r\n  if (aqi > 400 && aqi <= 500) return colorIndicator.severe;\r\n}","import React from 'react';\r\nimport { colorIndicator } from '../utils';\r\n\r\nconst AqiIndicator = () => {\r\n  return (\r\n    <ul className=\"indicator\">\r\n      <li>\r\n        <span style={{backgroundColor: colorIndicator.good}}></span>\r\n        <span>0-50 (Good)</span>\r\n      </li>\r\n      <li>\r\n        <span style={{backgroundColor: colorIndicator.satisfactory}}></span>\r\n        <span>50-100 (Satisfactory)</span>\r\n      </li>\r\n      <li>\r\n        <span style={{backgroundColor: colorIndicator.moderate}}></span>\r\n        <span>100-200 (Moderate)</span>\r\n      </li>\r\n      <li>\r\n        <span style={{backgroundColor: colorIndicator.poor}}></span>\r\n        <span>200-300 (Poor)</span>\r\n      </li>\r\n      <li>\r\n        <span style={{backgroundColor: colorIndicator.veryPoor}}></span>\r\n        <span>300-400 (Very Poor)</span>\r\n      </li>\r\n      <li>\r\n        <span style={{backgroundColor: colorIndicator.severe}}></span>\r\n        <span>400-500 (Severe)</span>\r\n      </li>\r\n    </ul>\r\n  )\r\n}\r\n\r\nexport default AqiIndicator;\r\n","import React from \"react\";\nimport { Aqi, AqiIndicator } from './components';\nimport \"./App.css\";\n\nconst App = () => {\n  return (\n    <div className=\"app\">\n      <header className=\"header\">\n        <h1>Air Quality Monitoring</h1>\n      </header>\n      <main>\n        <AqiIndicator />\n        <Aqi />\n      </main>\n    </div>\n  );\n};\n\nexport default App;\n","const reportWebVitals = onPerfEntry => {\n  if (onPerfEntry && onPerfEntry instanceof Function) {\n    import('web-vitals').then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {\n      getCLS(onPerfEntry);\n      getFID(onPerfEntry);\n      getFCP(onPerfEntry);\n      getLCP(onPerfEntry);\n      getTTFB(onPerfEntry);\n    });\n  }\n};\n\nexport default reportWebVitals;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\nimport reportWebVitals from './reportWebVitals';\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n\n// If you want to start measuring performance in your app, pass a function\n// to log results (for example: reportWebVitals(console.log))\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\nreportWebVitals();\n"],"sourceRoot":""}